<div class="card">
  <h1>Store Dashboard</h1>
  <table id="itemsTable">
    <thead>
      <tr><th>ID</th><th>Status</th><th>Storage</th><th>Actions</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
async function loadItems() {
  const res = await fetch('/api/reservations?status=stored');
  const items = await res.json();
  const tbody = document.querySelector('#itemsTable tbody');
  tbody.innerHTML = '';
  items.forEach(item => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${item.id}</td>
      <td>${item.status}</td>
      <td>${item.storageLocation || ''}</td>
      <td>
        <button onclick="moveToLoading('${item.id}')">Move to Loading Bay</button>
        <button onclick="markReady('${item.id}')">Mark Ready</button>
      </td>`;
    tbody.appendChild(tr);
  });
}

async function moveToLoading(id) {
  await fetch(`/api/reservations/${id}/move-to-loading`, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({by:'store'})});
  loadItems();
}

async function markReady(id) {
  await fetch(`/api/reservations/${id}/mark-ready`, {method:'POST'});
  loadItems();
}

loadItems();
</script>
