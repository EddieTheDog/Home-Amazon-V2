<div class="card">
  <h1>Front Desk</h1>
  <label>Reservation ID or Scan:</label>
  <input type="text" id="scanInput" placeholder="Enter Reservation ID">
  <button onclick="loadReservation()">Load</button>
</div>

<div id="reservationDetails" class="card" style="display:none;">
  <h2>Reservation Details</h2>
  <div id="details"></div>
  <label>Storage Location:</label>
  <input type="text" id="storageLocation">
  <button onclick="assignTracking()">Assign Tracking & Print Label</button>
</div>

<script>
let currentRes;

async function loadReservation() {
  const id = document.getElementById('scanInput').value;
  const res = await fetch('/api/reservations/' + id);
  if (!res.ok) { alert('Reservation not found'); return; }
  currentRes = await res.json();
  document.getElementById('reservationDetails').style.display = 'block';
  document.getElementById('details').innerText = JSON.stringify(currentRes, null, 2);
}

async function assignTracking() {
  if (!currentRes) return;
  const location = document.getElementById('storageLocation').value;
  const res = await fetch(`/api/reservations/${currentRes.id}/assign-tracking`, {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({ storageLocation: location })
  });
  const result = await res.json();
  alert('Tracking Assigned: ' + result.trackingNumber);
  window.open('/print_label/' + currentRes.id, '_blank');
}
</script>
