<div class="card">
  <h1>Create a Reservation</h1>
  <form id="reservationForm" method="POST" action="/api/reservations">
    <label>Item Description (required)</label>
    <input type="text" name="itemDescription" required>

    <label>Weight Estimate (optional)</label>
    <input type="text" name="weightEstimate">

    <label>Customer Name (optional)</label>
    <input type="text" name="customerName">

    <label>Customer Contact (optional)</label>
    <input type="text" name="customerContact">

    <button type="submit">Reserve</button>
  </form>
</div>

<div id="confirmation" class="card" style="display:none;">
  <h2>Reservation Created!</h2>
  <p>Your reservation ID: <span id="reservationId"></span></p>
  <p>QR Code:</p>
  <img id="qrImage" src="" alt="QR code">
  <p>Tracking URL: <a id="trackingUrl" href="" target="_blank"></a></p>
</div>

<script>
document.getElementById('reservationForm').addEventListener('submit', async e => {
  e.preventDefault();
  const form = e.target;
  const data = Object.fromEntries(new FormData(form).entries());
  const res = await fetch('/api/reservations', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
  });
  const result = await res.json();

  form.style.display = 'none';
  document.getElementById('confirmation').style.display = 'block';
  document.getElementById('reservationId').innerText = result.id;
  document.getElementById('qrImage').src = result.qrUrl;
  document.getElementById('trackingUrl').href = result.qrUrl;
  document.getElementById('trackingUrl').innerText = result.qrUrl;
});
</script>
